{
  "$id": "http://qs3p.insilicobio.ru/",
   "definitions": {
     "VarKind": {
       "type": "string",
       "enum": ["dynamic", "static", "rule"]
     },

     "ID": {
       "type": "string",
       "minLength": 1,
       "pattern": "^[_a-zA-Z][_a-zA-Z0-9]*$"
     },

     "Units": {
       "type": "string",
       "minLength": 1,
       "pattern": "^[_a-zA-Z0-9/][_a-zA-Z0-9/*]*$"
     },

     "SimpleQ": {
       "type": "object",
       "properties": {
         "class": {"type": "string"},
         "title": {"type": "string"},
         "notes": {"type": "string"},
         "tags": {
           "type": "array",
           "items": { "type": "string" }
         },
         "aux": {"type": "object"}
       }
     },

     "NumericQ": {
       "required": ["num"],
       "properties": {
         "num": {"type": "number"},
         "free": {"type": "boolean"}
       }
     },

    "ExpressionQ": {
      "required": ["expr"],
      "properties": {
        "expr": {"type": "string"},
        "lang": {"type": "string"}
      }
    },

    "VariableQ": {
      "type": "object",
      "properties": {
        "kind": { "$ref": "#/definitions/VarKind" },
        "units": {"$ref": "#/definitions/Units"},
        "size": {
          "anyOf": [
            { "$ref": "#/definitions/ExpressionQ" },
            { "$ref": "#/definitions/NumericQ" }
          ]
        }
      }
    },

    "QuantityQ": {
      "properties": {
        "variable": {"$ref": "#/definitions/VariableQ"}
      }
    },

    "CompartmentQ": {
    },

    "SpeciesQ": {
      "properties": {
        "compartmentRef": { "$ref": "#/definitions/ID" }
      }
    },

    "EffectorQ": {
      "type": "object",
      "required": ["targetRef"],
      "properties": {
        "targetRef": {"$ref": "#/definitions/ID"}
      }
    },

    "ActorQ": {
      "allOf": [
        {"$ref": "#/definitions/EffectorQ"},
        {
          "required": [],
          "properties": {
            "stoichiometry": {"type": "number"}
          }
        }
      ]
    },

    "ProcessQ": {
      "properties": {
        "variable": {
          "properties": {
            "kind": {
              "type": "string",
              "enum": ["rule"]
            }
          }
        },
        "effectors": {
          "type": "array",
          "items": { "$ref": "#/definitions/EffectorQ" }
        },
        "actors": {
          "type": "array",
          "items": { "$ref": "#/definitions/ActorQ" }
        }
      }
    },

    "ReactionQ": {
      "$ref": "#/definitions/ProcessQ"
    },

    "SceneQ": {
      "properties": {
        "scope": { "type": "string"},
        "kind": {"type": "string", "enum": ["kinetic"]},
        "method": {
          "type": "object",
          "properties": {
            "timeRange": {},
            "timeStep": {},
            "solver": {"type": "string", "enum": ["lsoda"]}
          }
        }
      }
    },

    "EventQ": {
      "properties": {
        "assignments": {
          "type": "array",
          "items": { "$ref": "#/definitions/AssignmentQ" }
        }
      }
    },

    "AssignmentQ": {
      "properties": {
        "targetRef": {"$ref": "#/definitions/ID"},
        "size": {
          "anyOf": [
            { "$ref": "#/definitions/ExpressionQ" },
            { "$ref": "#/definitions/NumericQ" }
          ]
        }
      }
    }
   }
}
